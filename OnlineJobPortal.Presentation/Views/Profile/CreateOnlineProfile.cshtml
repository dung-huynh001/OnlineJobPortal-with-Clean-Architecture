<style>
    a:hover {
        color: #17b85f !important;
    }

    .avatar-section {
        height: 150px;
        width: 150px;
        border: 1px solid #ccc;
        border-radius: 50%;
        overflow: hidden;
    }

    .avatar-section img {
        height: 150px;
        width: 150px;
        object-fit: fill;
    }

    .avatar-section__button {
        background-color: #ccc;
        width: 100%;
        overflow: hidden;
        top: 80%;
        padding: 2px;
        font-size: 1.2rem;
        display: none;
    }

    .avatar-section__button:hover {
        color: #17b85f;
        background-color: #ccddd3;
    }

    .avatar-section:hover .avatar-section__button {
        display: block;
    }
</style>

<main class="container-fluid min-vh-100 bg-light py-4">
    <div class="container min-vh-100 p-4">
        <form class="row" method="post" asp-area="" asp-controller="Profile" asp-action="UpdateProfile">
            <div class="col-12 mb-3">
                <section
                    class="d-flex flex-column flex-lg-row align-items-lg-center gap-3 gap-lg-5 bg-white p-3 rounded-3">
                    <div class="avatar-section position-relative">
                        <img id="avatar_image" src="~/img/default_user.png" alt="">

                        <input id="avatar_image-file" type="file" accept="image/*" hidden>
                        <input type="text" hidden>
                        <a role="button" onclick="$('#avatar_image-file').click()"
                            class="position-absolute text-center avatar-section__button" data-bs-toggle="tooltip"
                            data-bs-placement="bottom" title="Đổi ảnh đại diện">
                            <i class="fa-solid fa-camera"></i>
                        </a>
                    </div>
                    <div class="flex-grow-1">
                        <div class="border-bottom">
                            <h3>Poppy</h3>
                            <div class="d-flex gap-3 align-items-baseline">
                                <span class="text-muted fw-bold fs-5">Web Developer</span>
                                <span class="text-muted fw-bold fs-6">1YOE</span>
                            </div>
                            <span class="text-muted fs-6">Chưa cập nhật địa chỉ</span>
                        </div>
                        <div class="py-3">
                            <a role="button" class="btn btn-outline-primary"
                                onclick="$('#btn-upload-cv').click()">Upload CV</a>
                            <input id="btn-upload-cv" type="file" accept=".pdf, .doc, .docx" hidden>
                        </div>
                    </div>
                    <div class="align-self-start" data-bs-toggle="tooltip" data-bs-placement="bottom"
                        title="Cập nhật hồ sơ">
                        <a class="btn btn-outline-dark rounded-pill btn-edit">
                            <i class="fa-solid fa-gear pe-2"></i>Chỉnh sửa
                        </a>
                    </div>
                </section>
            </div>
            <div class="col-lg-8">
                <div class="row g-3">
                    <div class="col-12">
                        <section class="d-flex bg-white rounded-3 p-3 gap-3">
                            <div class="flex-grow-1 d-flex flex-column">
                                <h5>Tóm tắt</h5>
                                <p>Cung cấp thông tin chi tiết giúp chúng tôi dễ dàng tìm kiếm những công việc phù hợp
                                    với bạn.</p>
                            </div>
                            <div class="flex-shrink-0">
                                <img src="~/img/summary.svg" alt="">
                            </div>
                            <div class="flex-shrink-0 ps-4">
                                <a role="button" class="fw-bold fs-5 text-muted btn-show-modal"><i
                                        class="fa-regular fa-pen-to-square" data-info-area="Tóm tắt"
                                        data-bs-toggle="modal" data-bs-target="#staticBackdrop"></i></a>
                            </div>
                        </section>
                    </div>
                    <div class="col-12">
                        <section class="d-flex bg-white rounded-3 p-3">
                            <div class="flex-grow-1 d-flex flex-column">
                                <h5>Kỹ năng</h5>
                                <p>Chọn những kỹ năng thể hiện bạn phù hợp với vị trí, giúp bạn thu hút sự chú ý của nhà
                                    tuyển dụng và xem bạn là lựa chọn phù hợp.</p>
                            </div>
                            <div class="flex-shrink-0">
                                <img src="~/img/skill.svg" alt="">
                            </div>
                            <div class="flex-shrink-0 ps-4">
                                <a role="button" class="fw-bold fs-5 text-muted btn-show-modal"><i
                                        class="fa-regular fa-pen-to-square" data-info-area="Kỹ năng"
                                        data-bs-toggle="modal" data-bs-target="#staticBackdrop"></i></a>
                            </div>
                        </section>
                    </div>
                    <div class="col-12">
                        <section class="d-flex bg-white rounded-3 p-3">
                            <div class="flex-grow-1 d-flex flex-column">
                                <h5>Kinh nghiệm làm việc</h5>
                                <p>Kinh nghiệm chi tiết phản ánh kỹ năng, giá trị và đóng góp của bạn trong thời gian
                                    bạn làm việc tại các công ty trước đây.</p>
                            </div>
                            <div class="flex-shrink-0">
                                <img src="~/img/work-experience.svg" alt="">
                            </div>
                            <div class="flex-shrink-0 ps-4">
                                <a role="button" class="fw-bold fs-5 text-muted btn-show-modal"><i
                                        class="fa-regular fa-pen-to-square" data-info-area="Kinh nghiệm làm việc"
                                        data-bs-toggle="modal" data-bs-target="#staticBackdrop"></i></a>
                            </div>
                        </section>
                    </div>
                    <div class="col-12">
                        <section class="d-flex bg-white rounded-3 p-3">
                            <div class="flex-grow-1 d-flex flex-column">
                                <h5>Học vấn</h5>
                                <p>Thêm thông tin học vấn vào hồ sơ giúp tóm tắt nền tảng và giá trị mà bạn đã đạt được
                                    và có thể hỗ trợ cho công việc</p>
                            </div>
                            <div class="flex-shrink-0">
                                <img src="~/img/education.svg" alt="">
                            </div>
                            <div class="flex-shrink-0 ps-4">
                                <a role="button" class="fw-bold fs-5 text-muted btn-show-modal"><i
                                        class="fa-regular fa-pen-to-square" data-info-area="Học vấn"
                                        data-bs-toggle="modal" data-bs-target="#staticBackdrop"></i></a>
                            </div>
                        </section>
                    </div>
                    <div class="col-12">
                        <section class="d-flex bg-white rounded-3 p-3">
                            <div class="flex-grow-1 d-flex flex-column">
                                <h5>Dự án</h5>
                            </div>
                            <div class="flex-shrink-0 ps-4">
                                <a role="button" class="fw-bold fs-5 text-muted btn-show-modal"><i
                                        class="fa-regular fa-pen-to-square" data-info-area="Dự án"
                                        data-bs-toggle="modal" data-bs-target="#staticBackdrop"></i></a>
                            </div>
                        </section>
                    </div>
                    <div class="col-12">
                        <section class="d-flex bg-white rounded-3 p-3">
                            <div class="flex-grow-1 d-flex flex-column">
                                <h5>Ngoại ngữ</h5>
                            </div>
                            <div class="flex-shrink-0 ps-4">
                                <a role="button" class="fw-bold fs-5 text-muted btn-show-modal"><i
                                        class="fa-regular fa-pen-to-square" data-info-area="Ngoại ngữ"
                                        data-bs-toggle="modal" data-bs-target="#staticBackdrop"></i></a>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mt-3 mt-lg-0">
                <div class="row g-3">
                    <div class="col-12">
                        <div class="p-3 fw-bold rounded-3 bg-white">
                            <a class="btn btn-outline-dark rounded-pill" data-bs-toggle="collapse"
                                href="#collapseExample" role="button" aria-expanded="false"
                                aria-controls="collapseExample">
                                <i class="fa-solid fa-eye pe-2"></i>Xem CV
                            </a>
                        </div>
                        <div class="collapse" id="collapseExample">
                            <div class="bg-white" style="height: 200;">
                                <embed src="~/Uploads/CVs/0dbf7c4a-e757-4ce9-97f8-a212f02388fe_cv.pdf"
                                    type="application/pdf" height="200" width="100%">
                            </div>
                        </div>
                    </div>
                    <div class="col-12">
                        <div class="bg-white rounded-3">
                            <div class="form-check form-switch p-3 d-flex gap-3 rounded-3"
                                style="background-color: #fbd5d5;">
                                <input class="form-check-input ms-0" type="checkbox" id="flexSwitchCheckDefault">
                                <label class="form-check-label fw-bold" for="flexSwitchCheckDefault">Bật chế độ tìm
                                    việc</label>
                            </div>
                            <div class="p-3">
                                Bật chế độ tìm việc để kết nối với nhiều nhà tuyển dụng
                            </div>
                        </div>
                    </div>
                    <div class="col-12 position-relative">
                        <div class="carousel slide rounded-3" data-bs-ride="carousel">
                            <div class="carousel-inner">
                                <div class="carousel-item active" data-bs-interval="2000">
                                    <img src="~/img/resume-1.jpg" class="d-block w-100 rounded-3" alt="..."
                                        style="height: 400px">
                                </div>
                                <div class="carousel-item" data-bs-interval="2000">
                                    <img src="~/img/resume-2.jpg" class="d-block w-100 rounded-3" alt="..."
                                        style="height: 400px">
                                </div>
                            </div>
                            <div class="position-absolute d-flex justify-content-center w-100" style="bottom: 10%;">
                                <a asp-area="" asp-controller="Resume" asp-action="Index"
                                    class="btn btn-primary rounded-pill">Tạo CV</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</main>

<!-- Modal -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
    aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
        </div>
    </div>
</div>



@section Scripts {
    <script src="~/area/assets/plugins/vietnamlocal/vietnamlocalselector.min.js"></script>
    <script src="https://cdn.ckeditor.com/ckeditor5/40.0.0/classic/ckeditor.js"></script>
    <script>
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl)
        })

        $(document).ready(function () {
            const btnShowModal = $('.btn-show-modal');
            const modalContent = $('.modal-content');

            btnShowModal.click(function () {
                var title = $(this).find("i").data("info-area");
                renderModalContent(title);
            });

                function renderModalContent(title) {
                    var modalHeaderHtml = `
                            <div class="modal-header">
                                <h5 class="modal-title" id="staticBackdropLabel">${title}</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>`;

                    var modalFooterHtml = `
                            <div class="modal-footer">
                                <button type="button" class="btn btn-outline-danger rounded-3" data-bs-dismiss="modal">Hủy bỏ</button>
                                <button type="button" class="btn btn-outline-primary rounded-3">Lưu lại</button>
                            </div>`;

                    var modalBodyHtml = "";
                    switch (title.toLowerCase()) {
                        case "tóm tắt":
                            modalBodyHtml = `
                                    <div class="modal-body">
                                        <textarea class="form-control text-editor"></textarea>
                                    </div>`;
                            break;
                        case "kỹ năng":
                            modalBodyHtml = `
                                    <div class="modal-body">
                                        <select class="chosen-select" data-placeholder="Vd: C#, ASP.NET,..." multiple></select>
                                    </div>`;
                            break;
                        case "kinh nghiệm làm việc":
                            modalBodyHtml = `
                                    <div class="modal-body">
                                        <div class="d-flex flex-column gap-3">
                                            <div>
                                                <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Vị trí công việc</label>
                                                <input class="form-control" type="text">
                                            </div>
                                            <div>
                                                <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Tên công ty</label>
                                                <input class="form-control" type="text">
                                            </div>
                                            <div class="d-flex gap-3">
                                                <div class="flex-grow-1">
                                                    <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Ngày bắt đầu</label>
                                                    <input class="form-control" type="date">
                                                </div>
                                                <div class="flex-grow-1">
                                                    <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Ngày kết thúc</label>
                                                    <input class="form-control" type="date">
                                                </div>
                                            </div>
                                            <div>
                                                <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Mô tả</label>
                                                <textarea class="form-control text-editor"></textarea>
                                            </div>
                                        </div>
                                    </div>`;
                            break;
                        case "học vấn":
                            modalBodyHtml = `
                                    <div class="modal-body">
                                        <div class="d-flex flex-column gap-3">
                                            <div>
                                                <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Tên trường</label>
                                                <input class="form-control" type="text">
                                            </div>
                                            <div>
                                                <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Chuyên ngành</label>
                                                <input class="form-control" type="text">
                                            </div>
                                            <div class="d-flex gap-3">
                                                <div class="flex-grow-1">
                                                    <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Ngày bắt đầu</label>
                                                    <input class="form-control" type="date">
                                                </div>
                                                <div class="flex-grow-1">
                                                    <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Ngày kết thúc</label>
                                                    <input class="form-control" type="date">
                                                </div>
                                            </div>
                                            <div>
                                                <label class="text-dark" style="font-size: 0.9rem; font-weight: 600;">Mô tả</label>
                                                <textarea class="form-control text-editor"></textarea>
                                            </div>
                                        </div>
                                    </div>`;
                            break;
                        case "dự án":
                            modalBodyHtml = `
                                    <div class="modal-body">
                                        dự án
                                    </div>`;
                            break;
                        case "ngoại ngữ":
                            modalBodyHtml = `
                                    <div class="modal-body">
                                        ngoại ngữ
                                    </div>`;
                            break;
                        default: break;
                    }
                    modalContentHtml = modalHeaderHtml + modalBodyHtml + modalFooterHtml;
                    modalContent.html(modalContentHtml);

                    // Khởi tạo ck text editors
                    const editors = $(".text-editor");
                    editors.each((index, el) => {
                        ClassicEditor.create(el).catch((error) => {
                            console.error(error);
                        });
                    });

                    // Khởi tạo chosen selector
                    $(".chosen-select").chosen({
                        allow_single_deselect: true,
                        width: "100%",
                        no_results_text: "Không tìm thấy kết quả :",
                    });
                }


            //Tải ảnh lên tag img khi input thay đổi
            $("#avatar_image-file").change(function (e) {
                var avatarImg = $("#avatar_image");

                if (e.target.files.length > 0) {
                    var file = e.target.files[0];
                    var reader = new FileReader();

                    reader.onload = function (event) {
                        avatarImg.attr("src", event.target.result);
                    };

                    reader.readAsDataURL(file);
                } else {
                    avatarImg.attr("src", "");
                }
            });
        });
    </script>
}